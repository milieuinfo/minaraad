<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="minaraad">

    <metal:block metal:fill-slot="top_slot"
                tal:define="dummy python:request.set('disable_border',1)" />
    
    <body>
    <metal:block metal:fill-slot="prefs_configlet_main">
        
        <h1 i18n:translate="heading_subscribers_overview">Subscribers  overview</h1>
        
        <a class="link-parent"
        tal:attributes="href string: $portal_url/plone_control_panel"
        i18n:translate="label_up_to_plone_setup">
            Up to Site Setup
        </a>
        <tal:block tal:define="subscriptions view/subscriptions">
            <div i18n:translate="title_subscription" 
                 style="font-weight:bold">Subscriptions</div>
            
            <tal:block tal:repeat="subscription subscriptions">
            <span tal:condition="not:subscription/category" 
                tal:omit-tag="">
                <a tal:attributes="href string:${context/absolute_url}/subscribers_config.html?sub=${subscription/id}"
                tal:content="subscription/id"
                i18n:translate="" /> &nbsp; | &nbsp;
            </span>
            </tal:block>
            <br />
            <br />
            <div i18n:translate="" 
                 style="font-weight:bold">Hearing</div>
            
            <tal:block tal:repeat="theme view/subscriptions">
            <span tal:condition="theme/category" 
                  tal:omit-tag="">
            <span tal:condition="repeat/theme/odd" 
                  tal:omit-tag="">
                <a tal:content="theme/Title"
                   i18n:translate="" 
                   tal:attributes="href string:${context/absolute_url}/subscribers_config.html?sub=${theme/id}" /> 
                &nbsp; | &nbsp;
            </span>
            </span>
            </tal:block>
            <div style="height: 8px">&nbsp;</div>
            <tal:block tal:repeat="theme view/subscriptions">
            <span tal:condition="theme/category" 
                  tal:omit-tag="">
            <span tal:condition="repeat/theme/even" 
                  tal:omit-tag="">
                <a tal:content="theme/Title"
                   i18n:translate="" 
                   tal:attributes="href string:${context/absolute_url}/subscribers_config.html?sub=${theme/id}" /> 
                &nbsp; | &nbsp;
            </span>
            </span>
            </tal:block>
        </tal:block>
        <br />
        <br />
        <br />
        <tal:block tal:define="subscription request/sub|nothing"
                   tal:condition="subscription">
        
        <form method="get"
              tal:attributes="action string:${context/absolute_url}/$template_id">
            <input class="context"
                   type="hidden"
                   name="sub"
                   tal:attributes="value subscription" />

            <input class="context"
                    type="submit"
                    name="form.button.ExportEmail"
                    value="Export Email Subscribers"
                    i18n:attributes="value label_export_email;"
                    tal:attributes="tabindex tabindex/next;" />

            <input class="context"
                    type="submit"
                    name="form.button.ExportPost"
                    value="Export Post Subscribers"
                    i18n:attributes="value label_export_post;"
                    tal:attributes="tabindex tabindex/next;" />
        </form>

        <table class="listing">
            <thead>
                <tr>
                    <th i18n:translate="label_gender">
                        Gender
                    </th>
                    <th i18n:translate="label_firstname">
                        First name
                    </th>
                    <th i18n:translate="label_lastname">
                        Last name
                    </th>
                    <th i18n:translate="label_company">
                        Company
                    </th>
                    <th i18n:translate="label_jobtitle">
                        Job title
                    </th>
                    <th i18n:translate="label_street">
                        Street
                    </th>
                    <th i18n:translate="label_housenumber">
                        House number
                    </th>
                    <th i18n:translate="label_bus">
                        Bus
                    </th>
                    <th i18n:translate="label_zipcode">
                        Zipcode
                    </th>
                    <th i18n:translate="label_city">
                        City
                    </th>
                    <th i18n:translate="label_country">
                        Country
                    </th>
                    <th i18n:translate="label_phonenumber">
                        Phone number
                    </th>
                    <th i18n:translate="label_email">
                        E-mail
                    </th>
                    <th />
                </tr>
            </thead>
            <tbody>
                <tr tal:repeat="member python:view.getMembersOfSubscriptions(subscription)">
                    <td tal:content="member/gender" />
                    <td tal:content="member/firstname" />
                    <td tal:content="member/fullname" />
                    <td tal:content="member/company" />
                    <td tal:content="member/jobtitle" />
                    <td tal:content="member/street" />
                    <td tal:content="member/housenumber" />
                    <td tal:content="member/bus" />
                    <td tal:content="member/zipcode" />
                    <td tal:content="member/city" />
                    <td tal:condition="python:member.country != 'Ander land'">
                        <span tal:replace ="member/country" />
                    </td>
                    <td tal:condition="python:member.country == 'Ander land'">
                        <span tal:replace ="member/other_country" />
                    </td>
                    <td tal:content="member/phonenumber" />
                    <td tal:content="member/email" />
                    <td>
                        <span tal:content="python:view.getSubscriptionType(member, subscription)" />
                    </td>
                </tr>
            </tbody>
        </table>
        </tal:block>
    </metal:block>
    </body>
</html>
