<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="minaraad">

<metal:block metal:fill-slot="top_slot"
             tal:define="dummy python:request.set('disable_border',1)" />

    <body>
    <div metal:fill-slot="prefs_configlet_main">
       <script type="text/javascript">
function toggleSelect(triggerInput, namePrefix) {
    checked = triggerInput.checked;
    formEl = triggerInput.form;
    for (x = 0; x < formEl.elements.length; x++) {
        inputEl = formEl.elements[x];
        if (inputEl.name.indexOf(namePrefix) == 0) {
            inputEl.checked = checked;
        }
    }
}
       </script>

        <h1 i18n:translate="title_subscription">Subscriptions   </h1>

        <a class="link-parent"
           tal:attributes="href string: $portal_url/plone_memberprefs_panel"
           i18n:translate="label_up_to_my_preferences">
            Up to My Preferences
        </a>

        <p class="documentDescription" 
           i18n:translate="description_subscriptions_setup">
            Subscriptions settings for this member.
        </p>
        <br />
        <form action=""
              name="search"
              method="post"
              tal:attributes="action string:${request/ACTUAL_URL}">

            <table class="listing">
                <tr class="subscriptions-title">
                    <th
                        i18n:translate="title_subscription">Subscriptions</th>
                    <th i18n:translate="title_email">By E-mail</th>
                    <th i18n:translate="title_post">By Mail</th>
                </tr>
                <!-- subscriptions without thema's -->
                <tal:block tal:repeat="subscription view/subscriptions">
                <tr class="field" tal:condition="not:subscription/category">
                    <td>
                        <span tal:content="string:${subscription/Title}"
                            i18n:translate="" 
                            tal:omit-tag="" />
                    </td>
                    <td class="checkbox-centered">
                    <input type="checkbox"
                        class="noborder"
                        tal:condition="subscription/can_email"
                        tal:attributes="tabindex tabindex/next;
                                        id string:email_${subscription/id};
                                        name string:email_${subscription/id};
                                        value string:email_${subscription/id};
                                        checked subscription/subscribed_email" /> 
                    </td>
                    <td class="checkbox-centered">
                    <input type="checkbox"
                        class="noborder"
                        tal:condition="subscription/can_post"
                        tal:attributes="tabindex tabindex/next;
                                        id string:post_${subscription/id};
                                        name string:post_${subscription/id};
                                        value string:post_${subscription/id};
                                        checked subscription/subscribed_post" /> 
                    </td>
                </tr>
                </tal:block>
                
                <!-- subscriptions with thema's -->
                <tr>
                    <td class="hearingsubscriptiontitle">
                        <span i18n:translate="toggle_all" 
                                class="float-right">
                            Toggle all:
                        </span>
                        <span class="bold" 
                                i18n:translate="">
                            Hearing
                        </span>
                    </td>
                    <td class="checkbox-all">
                        <input type="checkbox"
                                name="selectButton"
                                title="Select all themes"
                                onClick="toggleSelect(this, 'email_theme_');"
                                i18n:attributes="title label_select_all_themes" />  
                    </td>
                    <td />
                </tr>
                <tal:block tal:repeat="subscription view/subscriptions">
                <tr class="field" 
                    tal:condition="subscription/category">
                    <td class="subscription-themes">
                        <span tal:content="string:${subscription/Title}"
                            i18n:translate="" 
                            tal:omit-tag="" />
                    </td>
                    <td class="checkbox-centered">
                    <input type="checkbox"
                        class="noborder"
                        tal:condition="subscription/can_email"
                        tal:attributes="tabindex tabindex/next;
                                        id string:email_${subscription/id};
                                        name string:email_${subscription/id};
                                        value string:email_${subscription/id};
                                        checked subscription/subscribed_email" /> 
                    </td>
                    <td />
                </tr>
                </tal:block>
            </table>
            <div class="formControls">
                <input class="context"
                        type="submit"
                        name="form.button.Save"
                        value="Save"
                        i18n:attributes="value label_save;"
                        tal:attributes="tabindex tabindex/next;" />
            </div>
        </form>
    </div>
    </body>
</html>
